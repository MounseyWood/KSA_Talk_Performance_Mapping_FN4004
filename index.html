<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FN4004 Design Process 1 – Assessment Mapping Tool</title>
  <style>
    /* Base styles from the sample HTML */
    body {
      font-family: Arial, Helvetica, sans-serif;
      background-color: white;
      padding: 0;
      margin: 0;
      color: #333;
      line-height: 1.6;
    }
    .content-wrapper {
      width: 100%;
      max-width: 1600px;
      margin: 0 auto;
      padding: 0;
    }
    .content {
      background-color: white;
      padding: 30px;
      margin-bottom: 0;
    }
    .header {
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 3px solid #aaaaaa;
      padding-bottom: 20px;
    }
    .logo {
      max-height: 300px;
      margin-bottom: 15px;
      width: auto;
    }
    h1 {
      font-size: 24px;
      margin-bottom: 16px;
    }
    h2 {
      font-size: 20px;
      margin-top: 20px;
      margin-bottom: 12px;
    }
    h3 {
      font-size: 16px;
      margin-top: 16px;
      margin-bottom: 8px;
    }
    .footer {
      text-align: center;
      margin-top: 30px;
      padding: 20px;
      color: #666;
      font-size: 0.9rem;
      border-top: 1px solid #eee;
    }
    /* Button styles */
    .btn {
      display: inline-block;
      padding: 8px 16px;
      border-radius: 2px;
      font-weight: 500;
      cursor: pointer;
      margin: 4px;
      transition: all 0.2s;
      border: none;
      font-size: 1rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .btn:hover {
      opacity: 0.9;
    }
    .btn-grade {
      background-color: #f1f1f1;
      color: #333;
      min-width: 70px;
    }
    .btn-grade.active {
      outline: 2px solid #666;
      outline-offset: 2px;
    }
    .btn-outcome {
      background-color: #f1f1f1;
      color: #333;
    }
    .btn-outcome.active {
      background-color: #3b82f6;
      color: white;
    }
    .ku-button {
      display: inline-block;
      background-color: #FFF200;
      color: #000;
      font-weight: bold;
      font-size: 1rem;
      padding: 12px 15px;
      height: 45px;
      box-sizing: border-box;
      border-radius: 2px;
      text-decoration: none;
      margin: 10px 5px;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s;
      line-height: 1.4;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .ku-button:hover {
      background-color: #E6D900;
    }
    /* Section containers */
    .grade-section,
    .advice-section,
    .feedback-card,
    .outcome-content {
      border: 1px solid #e5e7eb;
      padding: 16px;
      border-radius: 2px;
      margin-bottom: 24px;
      background-color: #f9fafb;
    }
    .feedback-card {
      background-color: white;
      margin-bottom: 16px;
    }
    .framework-field {
      color: #3b82f6;
      font-weight: 500;
    }
    .section-title {
      font-weight: 700;
      color: #000;
    }
    /* Grade colour classes (from the visual grade descriptors colour palette) */
    .first-plus {
      background-color: #80FF80;
    }
    .first {
      background-color: #BFFF80;
    }
    .upper-second {
      background-color: #FFFF80;
    }
    .lower-second {
      background-color: #FFE880;
    }
    .third {
      background-color: #FFCC80;
    }
    .marginal-fail {
      background-color: #FF9980;
    }
    .fail {
      background-color: #FF8080;
    }
    /* Layout for input and results – using a simple vertical layout */
    .section-title-large {
      font-size: 1.25rem;
      margin-bottom: 12px;
    }
    .buttons-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin-bottom: 16px;
    }
    .footer-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 30px;
    }
    .note {
      font-size: 14px;
      color: #666;
      padding: 12px;
      background-color: #f1f1f1;
      border-left: 4px solid #FFF200;
      margin-top: 24px;
      border-radius: 2px;
    }
    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.5);
    }
    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 20px;
      border-radius: 2px;
      max-width: 90%;
      max-height: 85vh;
      overflow-y: auto;
    }
    .close-modal {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }
    .close-modal:hover {
      color: black;
    }
    .matrix-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    .matrix-table th,
    .matrix-table td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: left;
      vertical-align: top;
    }
    .matrix-table th:first-child {
      background-color: #f1f1f1;
      font-weight: bold;
      width: 20%;
      text-align: left !important;
    }
    .matrix-table tr:first-child th {
      text-align: center;
      padding: 8px;
      color: black;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- Load React, ReactDOM, and Babel -->
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

  <!-- Our React component (using JSX) -->
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const FN4004MappingTool = () => {
      // Data definitions
      const learningOutcomes = [
        {
          id: 'outcome1',
          title: 'LO1: Research for Creative Design',
          description: 'Use research sources as a basis for creative design by exploring, evaluating and originating ideas into contemporary fashion concepts.',
          framework: 'Research and Analysis'
        },
        {
          id: 'outcome2',
          title: 'LO2: Design Development Process',
          description: 'Creatively generate, collate and record information appropriate to the design development process.',
          framework: 'Experimentation and Practice'
        },
        {
          id: 'outcome3',
          title: 'LO3: Material Understanding',
          description: 'Demonstrate an understanding of material qualities and evaluate their application and appropriateness to design outcomes.',
          framework: 'Experimentation and Practice'
        },
        {
          id: 'outcome4',
          title: 'LO4: Historical & Ethical Research',
          description: 'Advance research into creative concepts that recognise historical and/or ethical and social considerations.',
          framework: 'Research and Analysis'
        },
        {
          id: 'outcome5',
          title: 'LO5: Design Communication',
          description: 'Communicate design outcomes using a variety of traditional and contemporary methods appropriate to professional contexts.',
          framework: 'Communication and Presentation'
        },
        {
          id: 'outcome6',
          title: 'Personal & Professional Development',
          description: 'Demonstrate effective planning, time-management, commitment & subject engagement, including the ability to work independently and collaboratively.',
          framework: 'Personal and Professional Development'
        }
      ];

      const gradeBands = [
        { id: 'first-plus', title: 'First Class (A+)', ranges: ['100%', '98%', '95%', '92%', '88%', '85%'], quality: 'Outstanding' },
        { id: 'first', title: 'First Class (A)', ranges: ['82%', '78%', '75%', '72%', '70%'], quality: 'Very Good' },
        { id: 'upper-second', title: 'Upper Second (B)', ranges: ['68%', '65%', '62%', '60%'], quality: 'Good' },
        { id: 'lower-second', title: 'Lower Second (C)', ranges: ['58%', '55%', '52%', '50%'], quality: 'Satisfactory' },
        { id: 'third', title: 'Third Class (D)', ranges: ['48%', '45%', '42%', '40%'], quality: 'Adequate' },
        { id: 'marginal-fail', title: 'Marginal Fail (FM)', ranges: ['38%', '35%'], quality: 'Unsatisfactory' },
        { id: 'fail', title: 'Fail (F)', ranges: ['32%', '28%', '25%', '22%', '0%'], quality: 'Poor' }
      ];

      // Feedback data for each outcome and grade band (sample text)
      const feedbackData = {
        outcome1: {
          'first-plus': {
            strength: 'Outstanding use of research sources; original and insightful.',
            evidence: 'Comprehensive exploration and critical analysis.',
            improvement: 'Keep pushing boundaries with interdisciplinary sources.'
          },
          'first': {
            strength: 'Excellent research with creative application.',
            evidence: 'Deep analysis and thoughtful integration.',
            improvement: 'Challenge yourself with more unexpected sources.'
          },
          'upper-second': {
            strength: 'Good use of research as a foundation for design.',
            evidence: 'Solid evaluation skills evident.',
            improvement: 'Develop more creative connections.'
          },
          'lower-second': {
            strength: 'Satisfactory research with some evaluation.',
            evidence: 'Basic research is evident.',
            improvement: 'Strengthen analytical skills and clarity.'
          },
          'third': {
            strength: 'Adequate research with limited depth.',
            evidence: 'Some sources but mostly descriptive.',
            improvement: 'Expand and critically analyze your sources.'
          },
          'marginal-fail': {
            strength: 'Limited research presented.',
            evidence: 'Minimal evaluation and connection to design.',
            improvement: 'Adopt a more structured research approach.'
          },
          'fail': {
            strength: 'Very little research evident.',
            evidence: 'No clear analysis or evaluation.',
            improvement: 'Develop basic research skills and apply them to your design process.'
          }
        },
        outcome2: {
          'first-plus': {
            strength: 'Exceptional creativity in documenting design development.',
            evidence: 'Innovative and well-organized documentation.',
            improvement: 'Keep exploring cutting-edge methods.'
          },
          'first': {
            strength: 'Excellent idea generation and recording.',
            evidence: 'Well-structured and creative documentation.',
            improvement: 'Experiment with even more innovative approaches.'
          },
          'upper-second': {
            strength: 'Good confidence in generating and recording ideas.',
            evidence: 'Clear progression evident in your work.',
            improvement: 'Develop more originality in presentation.'
          },
          'lower-second': {
            strength: 'Satisfactory documentation with creative elements.',
            evidence: 'Adequate recording of ideas.',
            improvement: 'Improve clarity and organization.'
          },
          'third': {
            strength: 'Basic ability to record design ideas.',
            evidence: 'Documentation is minimal and unstructured.',
            improvement: 'Adopt a more systematic approach.'
          },
          'marginal-fail': {
            strength: 'Limited documentation of ideas.',
            evidence: 'Poor recording and lack of organization.',
            improvement: 'Work on basic recording methods.'
          },
          'fail': {
            strength: 'Insufficient documentation of the design process.',
            evidence: 'Chaotic or minimal record keeping.',
            improvement: 'Learn and apply fundamental documentation techniques.'
          }
        },
        outcome3: {
          'first-plus': {
            strength: 'Outstanding understanding and evaluation of materials.',
            evidence: 'Highly creative application of material qualities.',
            improvement: 'Explore even more innovative material uses.'
          },
          'first': {
            strength: 'Excellent material understanding and evaluation.',
            evidence: 'Well-analyzed material properties.',
            improvement: 'Push for more experimental applications.'
          },
          'upper-second': {
            strength: 'Good understanding with solid evaluation.',
            evidence: 'Appropriate application of materials to design.',
            improvement: 'Develop more creative or unexpected applications.'
          },
          'lower-second': {
            strength: 'Satisfactory material understanding.',
            evidence: 'Basic evaluation is evident.',
            improvement: 'Enhance depth of material investigation.'
          },
          'third': {
            strength: 'Basic understanding of material properties.',
            evidence: 'Limited evaluation of material choices.',
            improvement: 'Work on structured material testing and evaluation.'
          },
          'marginal-fail': {
            strength: 'Very limited material understanding.',
            evidence: 'Almost no evaluation provided.',
            improvement: 'Build foundational knowledge of materials.'
          },
          'fail': {
            strength: 'No evidence of material understanding.',
            evidence: 'Missing material evaluation entirely.',
            improvement: 'Develop basic principles of material properties.'
          }
        },
        outcome4: {
          'first-plus': {
            strength: 'Exceptional contextual research with deep historical and ethical insight.',
            evidence: 'Sophisticated analysis of context.',
            improvement: 'Continue to challenge conventional narratives.'
          },
          'first': {
            strength: 'Excellent research with strong contextual awareness.',
            evidence: 'Good integration of historical and ethical aspects.',
            improvement: 'Push further into critical analysis of power structures.'
          },
          'upper-second': {
            strength: 'Good research with clear recognition of context.',
            evidence: 'Adequate historical and ethical connections.',
            improvement: 'Deepen the analysis of social implications.'
          },
          'lower-second': {
            strength: 'Satisfactory contextual research.',
            evidence: 'Basic recognition of historical/ethical issues.',
            improvement: 'Strengthen connections to design outcomes.'
          },
          'third': {
            strength: 'Basic research with minimal contextual integration.',
            evidence: 'Limited acknowledgment of context.',
            improvement: 'Develop a structured approach to contextual research.'
          },
          'marginal-fail': {
            strength: 'Very limited research into context.',
            evidence: 'Minimal recognition of historical or ethical issues.',
            improvement: 'Build a basic understanding of contextual frameworks.'
          },
          'fail': {
            strength: 'No evidence of contextual research.',
            evidence: 'Lacks historical and ethical analysis.',
            improvement: 'Learn fundamental principles of contextual research in design.'
          }
        },
        outcome5: {
          'first-plus': {
            strength: 'Outstanding communication with innovative presentation techniques.',
            evidence: 'Masterful integration of traditional and contemporary methods.',
            improvement: 'Keep exploring alternative presentation technologies.'
          },
          'first': {
            strength: 'Excellent communication of design outcomes.',
            evidence: 'Highly professional presentation.',
            improvement: 'Experiment with more unexpected communication methods.'
          },
          'upper-second': {
            strength: 'Good communication using appropriate methods.',
            evidence: 'Clear and effective presentation.',
            improvement: 'Develop more creative techniques for maximum impact.'
          },
          'lower-second': {
            strength: 'Satisfactory communication with some creative elements.',
            evidence: 'Adequate presentation overall.',
            improvement: 'Enhance consistency and professional polish.'
          },
          'third': {
            strength: 'Basic communication with limited variety.',
            evidence: 'Presentation is minimal.',
            improvement: 'Adopt a wider range of techniques.'
          },
          'marginal-fail': {
            strength: 'Very limited communication skills evident.',
            evidence: 'Presentation is poor.',
            improvement: 'Learn fundamental presentation skills.'
          },
          'fail': {
            strength: 'No effective communication of design outcomes.',
            evidence: 'Lacks clarity in presentation.',
            improvement: 'Develop basic communication strategies.'
          }
        },
        outcome6: {
          'first-plus': {
            strength: 'Exceptional commitment and self-management.',
            evidence: 'Excellent planning and leadership qualities.',
            improvement: 'Consider mentoring others to share your approach.'
          },
          'first': {
            strength: 'Excellent professional conduct and time management.',
            evidence: 'Very strong engagement throughout projects.',
            improvement: 'Develop further leadership skills in group settings.'
          },
          'upper-second': {
            strength: 'Good commitment and consistent professional conduct.',
            evidence: 'Effective time management and engagement.',
            improvement: 'Work on further refining planning strategies.'
          },
          'lower-second': {
            strength: 'Satisfactory self-management and professional conduct.',
            evidence: 'Reasonable planning but inconsistent execution.',
            improvement: 'Improve consistency in planning and execution.'
          },
          'third': {
            strength: 'Basic commitment with limited professional conduct.',
            evidence: 'Poor time management and engagement.',
            improvement: 'Develop fundamental planning and team work skills.'
          },
          'marginal-fail': {
            strength: 'Very limited commitment and poor self-management.',
            evidence: 'Lack of effective planning and engagement.',
            improvement: 'Adopt basic time management techniques.'
          },
          'fail': {
            strength: 'No evidence of professional conduct.',
            evidence: 'Very poor self-management and planning.',
            improvement: 'Develop basic professional and time management skills.'
          }
        }
      };

      const overallImprovements = {
        fail: [
          'Develop basic understanding of research methods and design processes',
          'Begin to analyze materials rather than just describing them',
          'Improve documentation of your design development process',
          'Show evidence of basic material investigation',
          'Practice fundamental presentation techniques',
          'Develop basic time management and planning skills'
        ],
        'marginal-fail': [
          'Strengthen your research with more diverse sources',
          'Show clearer connections between research and design development',
          'Improve organization and documentation of your design process',
          'Conduct more thorough material investigations',
          'Practice basic presentation techniques for more professional outcomes',
          'Improve your self-management and planning'
        ],
        third: [
          'Expand your research beyond obvious sources',
          'Develop better analytical skills rather than just describing',
          'Improve organization of your design development process',
          'Conduct more detailed material investigations with clearer evaluation',
          'Show more consistent professionalism in presentation',
          'Demonstrate more consistent engagement throughout projects'
        ],
        'lower-second': [
          'Deepen your research and show stronger critical analysis',
          'Make clearer connections between research and design development',
          'Show more creative exploration in your design process',
          'Enhance material investigations with more thoughtful evaluation',
          'Improve consistency in professional presentation standards',
          'Work on more effective planning and time management'
        ],
        'upper-second': [
          'Extend research beyond expected sources with deeper critical analysis',
          'Show more innovative connections between research and design',
          'Demonstrate more creative exploration and risk-taking',
          'Develop more sophisticated evaluation of materials and applications',
          'Refine presentation techniques for more professional outcomes',
          'Improve self-reflection and engagement with feedback'
        ],
        first: [
          'Push research to discover unexpected connections and insights',
          'Take more creative risks that result in innovative outcomes',
          'Demonstrate exceptional critical thinking throughout',
          'Perfect technical execution in all aspects',
          'Explore innovative presentation methods while maintaining clarity',
          'Develop leadership skills and initiative in collaborative contexts'
        ],
        'first-plus': [
          'Continue your outstanding work across all learning outcomes',
          'Consider mentoring others to share your exceptional approach',
          'Explore opportunities to showcase your work professionally',
          'Maintain your excellent standard while continuing to innovate',
          'Develop your professional network and industry connections'
        ]
      };

      // Initialize state for performance per outcome
      // Each outcome will store a selected grade band and a specific mark (default to first item in band)
      const initialPerformance = {};
      learningOutcomes.forEach(o => {
        const defaultGrade = gradeBands[0];
        initialPerformance[o.id] = {
          bandId: defaultGrade.id,
          percentage: defaultGrade.ranges[defaultGrade.ranges.length - 1]
        };
      });
      const [performanceLevels, setPerformanceLevels] = useState(initialPerformance);

      // For modal visibility (only matrix modal here for brevity)
      const [showMatrixModal, setShowMatrixModal] = useState(false);

      // Radar chart canvas ref
      const canvasRef = useRef(null);

      // Draw radar chart when performanceLevels change
      useEffect(() => {
        if (!canvasRef.current) return;
        const canvas = canvasRef.current;
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const radius = Math.min(centerX, centerY) - 30;
        const numAxes = learningOutcomes.length;
        const angleStep = (Math.PI * 2) / numAxes;
        // Draw concentric circles (one per grade band)
        const gradeCount = gradeBands.length;
        const radiusStep = radius / gradeCount;
        for (let i = 1; i <= gradeCount; i++) {
          const r = radiusStep * i;
          ctx.beginPath();
          ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
          ctx.strokeStyle = i === gradeCount ? "#333" : "#ddd";
          ctx.stroke();
        }
        // Plot data points for each outcome
        const dataPoints = [];
        for (let i = 0; i < numAxes; i++) {
          const outcome = learningOutcomes[i];
          const perf = performanceLevels[outcome.id];
          const gradeIndex = gradeBands.findIndex(g => g.id === perf.bandId);
          const reversedIndex = gradeBands.length - gradeIndex - 1;
          const pointRadius = radiusStep * (reversedIndex + 0.5);
          const angle = i * angleStep - Math.PI / 2;
          const x = centerX + pointRadius * Math.cos(angle);
          const y = centerY + pointRadius * Math.sin(angle);
          dataPoints.push({ x, y });
        }
        // Draw polygon
        ctx.beginPath();
        ctx.moveTo(dataPoints[0].x, dataPoints[0].y);
        dataPoints.forEach((pt, idx) => {
          if (idx > 0) ctx.lineTo(pt.x, pt.y);
        });
        ctx.closePath();
        ctx.fillStyle = "rgba(59, 130, 246, 0.3)";
        ctx.fill();
        ctx.strokeStyle = "rgba(59, 130, 246, 0.8)";
        ctx.lineWidth = 2;
        ctx.stroke();
        // Draw data points circles
        dataPoints.forEach(pt => {
          ctx.beginPath();
          ctx.arc(pt.x, pt.y, 6, 0, Math.PI * 2);
          ctx.fillStyle = "#FFF200";
          ctx.fill();
          ctx.strokeStyle = "#333";
          ctx.lineWidth = 1;
          ctx.stroke();
        });
      }, [performanceLevels]);

      // Handlers for grade band and specific percentage changes per outcome
      const handleGradeBandChange = (outcomeId, gradeId) => {
        const grade = gradeBands.find(g => g.id === gradeId);
        setPerformanceLevels({
          ...performanceLevels,
          [outcomeId]: {
            bandId: gradeId,
            percentage: grade.ranges[grade.ranges.length - 1]
          }
        });
      };

      const handlePercentageChange = (outcomeId, percentage) => {
        let gradeBandId = null;
        for (const band of gradeBands) {
          if (band.ranges.includes(percentage)) {
            gradeBandId = band.id;
            break;
          }
        }
        if (gradeBandId) {
          setPerformanceLevels({
            ...performanceLevels,
            [outcomeId]: { bandId: gradeBandId, percentage }
          });
        }
      };

      // Calculate average grade (simple average of percentages)
      const calculateAverageGrade = () => {
        const nums = Object.values(performanceLevels).map(p => parseFloat(p.percentage.replace('%', '')));
        const avg = nums.reduce((s, v) => s + v, 0) / nums.length;
        // Find the corresponding grade band (simplified lookup)
        const band = gradeBands.find(b => {
          const nums = b.ranges.map(r => parseFloat(r.replace('%', '')));
          return avg >= Math.min(...nums) && avg <= Math.max(...nums);
        }) || gradeBands[gradeBands.length - 1];
        // For display, round the average to nearest whole number
        return {
          numericValue: Math.round(avg),
          bandId: band.id,
          bandTitle: band.title,
          letterGrade: band.id === 'first-plus' ? 'A+' :
                       band.id === 'first' ? 'A' :
                       band.id === 'upper-second' ? 'B' :
                       band.id === 'lower-second' ? 'C' :
                       band.id === 'third' ? 'D' :
                       band.id === 'marginal-fail' ? 'FM' : 'F'
        };
      };

      // Render the tool
      return (
        <div className="content-wrapper">
          <div className="content">
            {/* Header */}
            <div className="header">
              <img src="Talk_FN4004.png" alt="FN4004 Design Process 1 Assessment Tool" className="logo" />
              <p style={{ fontSize: "14px", margin: "25px auto 0", backgroundColor: "#f1f1f1", padding: "12px", borderRadius: "2px", maxWidth: "800px" }}>
                This interactive tool helps you understand how your performance varies across different learning outcomes. Select your grade band and specific mark for each outcome to receive targeted feedback and visualize your overall profile.
              </p>
            </div>

            {/* Performance Level Input Section */}
            <h2 className="section-title-large">Your Performance Level by Outcome</h2>
            {learningOutcomes.map(outcome => (
              <div key={outcome.id} style={{ marginBottom: "24px" }}>
                <h3>{outcome.title}</h3>
                <p>{outcome.description}</p>
                <p className="framework-field">Framework: {outcome.framework}</p>
                {/* Grade Band Buttons */}
                <div className="buttons-container">
                  {gradeBands.map(grade => (
                    <button
                      key={grade.id}
                      className={`btn btn-grade ${performanceLevels[outcome.id].bandId === grade.id ? "active " + grade.id : ""}`}
                      onClick={() => handleGradeBandChange(outcome.id, grade.id)}
                    >
                      {grade.ranges[0]}
                    </button>
                  ))}
                </div>
                {/* Specific Mark Buttons */}
                <div className="buttons-container">
                  {gradeBands
                    .find(g => g.id === performanceLevels[outcome.id].bandId)
                    .ranges.map(mark => (
                      <button
                        key={mark}
                        className={`btn ${performanceLevels[outcome.id].percentage === mark ? "active" : ""}`}
                        onClick={() => handlePercentageChange(outcome.id, mark)}
                      >
                        {mark}
                      </button>
                    ))}
                </div>
              </div>
            ))}

            {/* Radar Chart */}
            <h2 className="section-title-large">Your Performance Profile</h2>
            <div className="feedback-card" style={{ textAlign: "center" }}>
              <canvas ref={canvasRef} width={400} height={400} style={{ maxWidth: "100%" }}></canvas>
            </div>

            {/* Average Grade Display */}
            <div className="grade-section">
              <h2>Indicative Average Grade</h2>
              <p style={{ textAlign: "center", fontSize: "1.2rem" }}>
                {calculateAverageGrade().numericValue}% ({calculateAverageGrade().letterGrade} – {calculateAverageGrade().bandTitle})
              </p>
            </div>

            {/* Key Areas for Improvement */}
            <div className="advice-section">
              <h3>Key Areas for Improvement</h3>
              <ul>
                {overallImprovements[calculateAverageGrade().bandId].map((advice, idx) => (
                  <li key={idx}>{advice}</li>
                ))}
              </ul>
            </div>

            {/* Detailed Feedback per Outcome */}
            <h2 className="section-title-large">Your Detailed Assessment Profile</h2>
            {learningOutcomes.map(outcome => {
              const perf = performanceLevels[outcome.id];
              const grade = gradeBands.find(g => g.id === perf.bandId);
              const feedback = feedbackData[outcome.id][perf.bandId];
              return (
                <div key={outcome.id} className="feedback-card">
                  <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: "8px" }}>
                    <h3>{outcome.title}</h3>
                    <div style={{ textAlign: "right" }}>
                      <span className={grade.id + " btn-grade"} style={{ padding: "4px 8px", fontWeight: "bold" }}>
                        {grade.title}
                      </span>
                      <br />
                      <span>{perf.percentage}</span>
                    </div>
                  </div>
                  <p><strong>Strengths:</strong> {feedback.strength}</p>
                  <p><strong>Evidence:</strong> {feedback.evidence}</p>
                  <p><strong>For improvement:</strong> {feedback.improvement}</p>
                </div>
              );
            })}

            {/* Footer Buttons */}
            <div className="footer-buttons">
              <button className="ku-button" onClick={() => alert("Profile saved (stub)!")}>
                Save My Assessment Profile
              </button>
              <button className="ku-button" onClick={() => alert("Compare functionality not implemented in this demo.")}>
                Compare with Previous Assessments
              </button>
              <button className="ku-button" onClick={() => window.print()}>
                Print Assessment Summary
              </button>
              <button className="ku-button" onClick={() => setShowMatrixModal(true)}>
                Complete FN4004 Grade Descriptor Matrix
              </button>
              <a href="https://canvas.kingston.ac.uk/courses/8255/pages/7-fairness-in-assessment" className="ku-button" target="_blank">
                Fairness in Assessment
              </a>
              <a href="https://kingstonuniversity.sharepoint.com/sites/mykingston/mysupport/myskills/Pages/default.aspx" className="ku-button" target="_blank">
                Support for Building Academic Skills
              </a>
              <a href="https://canvas.kingston.ac.uk/courses/32501" className="ku-button" target="_blank" title="Back to Module Home Page">
                Back to Module Home Page
              </a>
            </div>

            {/* Note */}
            <div className="note">
              <p>
                Note: This assessment summary is for reference only and is a visual interpretation of the Kingston School of Art BA (Hons) Fashion grade descriptors for FN4004. Always refer to the official grade descriptors in your course handbook.
              </p>
            </div>

            {/* Footer */}
            <div className="footer">
              <p>Kingston School of Art - BA (Hons) Fashion Program – Learning Outcomes, Feedback and Assessment Knowledge Base</p>
              <p>© 2025 Kingston University</p>
            </div>
          </div>

          {/* Grade Descriptor Matrix Modal */}
          {showMatrixModal && (
            <div className="modal" onClick={(e) => { if(e.target.className==='modal') setShowMatrixModal(false); }}>
              <div className="modal-content">
                <span className="close-modal" onClick={() => setShowMatrixModal(false)}>&times;</span>
                <h2>Complete FN4004 Grade Descriptor Matrix</h2>
                <p>The following matrix maps the FN4004 Learning Outcomes against grade descriptors.</p>
                <table className="matrix-table">
                  <thead>
                    <tr>
                      <th>Learning Outcomes</th>
                      <th className="first-plus">First Class (A+)<br>85-100%</th>
                      <th className="first">First Class (A)<br>70-84%</th>
                      <th className="upper-second">Upper Second (B)<br>60-69%</th>
                      <th className="lower-second">Lower Second (C)<br>50-59%</th>
                      <th className="third">Third Class (D)<br>40-49%</th>
                      <th className="marginal-fail">Marginal Fail (FM)<br>35-39%</th>
                      <th className="fail">Fail (F)<br>0-34%</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>LO1:<br>Research for Creative Design</th>
                      <td>Outstanding use of research sources; highly original.</td>
                      <td>Excellent use with deep understanding.</td>
                      <td>Good foundation with solid evaluation.</td>
                      <td>Satisfactory use with basic evaluation.</td>
                      <td>Adequate understanding with limited depth.</td>
                      <td>Limited research evidence.</td>
                      <td>Very little research evident.</td>
                    </tr>
                    <tr>
                      <th>LO2:<br>Design Development Process</th>
                      <td>Exceptional creativity and documentation.</td>
                      <td>Excellent idea generation and recording.</td>
                      <td>Good progression and documentation.</td>
                      <td>Satisfactory recording with some creativity.</td>
                      <td>Basic documentation and organization.</td>
                      <td>Limited documentation.</td>
                      <td>Insufficient evidence of process.</td>
                    </tr>
                    <tr>
                      <th>LO3:<br>Material Understanding</th>
                      <td>Outstanding evaluation of materials.</td>
                      <td>Excellent material knowledge.</td>
                      <td>Good evaluation and application.</td>
                      <td>Satisfactory understanding of materials.</td>
                      <td>Basic material evaluation.</td>
                      <td>Very limited material understanding.</td>
                      <td>Almost no evaluation provided.</td>
                    </tr>
                    <tr>
                      <th>LO4:<br>Historical & Ethical Research</th>
                      <td>Exceptional contextual research.</td>
                      <td>Excellent integration of context.</td>
                      <td>Good recognition of historical/ethical issues.</td>
                      <td>Satisfactory research with basic context.</td>
                      <td>Basic understanding of context.</td>
                      <td>Limited contextual awareness.</td>
                      <td>No contextual research evident.</td>
                    </tr>
                    <tr>
                      <th>LO5:<br>Design Communication</th>
                      <td>Outstanding communication and presentation.</td>
                      <td>Excellent professional presentation.</td>
                      <td>Good communication of outcomes.</td>
                      <td>Satisfactory presentation with room for improvement.</td>
                      <td>Basic communication skills.</td>
                      <td>Limited ability to communicate effectively.</td>
                      <td>No clear communication evident.</td>
                    </tr>
                    <tr>
                      <th>LO6:<br>Personal & Professional Development</th>
                      <td>Exceptional self-management and leadership.</td>
                      <td>Excellent professional conduct.</td>
                      <td>Good commitment and time management.</td>
                      <td>Satisfactory engagement and planning.</td>
                      <td>Basic self-management skills.</td>
                      <td>Very limited professional conduct.</td>
                      <td>No evidence of self-management.</td>
                    </tr>
                  </tbody>
                </table>
                <div style={{ textAlign: "center", marginTop: "20px" }}>
                  <button className="ku-button" onClick={() => setShowMatrixModal(false)}>Close</button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    };

    ReactDOM.render(<FN4004MappingTool />, document.getElementById("root"));
  </script>
</body>
</html>
